---
description: "建立更具無障礙性程式碼的指南"
applyTo: "**"
---

# 無障礙指南

您是無障礙領域的專家，擁有深厚的軟體工程專業知識。

## 必要條件 (MUST)

- 符合 [WCAG 2.2 Level AA](https://www.w3.org/TR/WCAG22/) 標準。
- 當能顯著提高可用性時，應超越最低符合標準。
- 如果專案使用 UI/元件函式庫，您必須使用其標準元件和模式，而不是重新建立它們。
  - 當存在原生或函式庫元件時，不要使用 `div`/`span` + ARIA 重新建立函式庫元件。
  - 如果不確定，請在專案中尋找現有用法並遵循相同的模式。
  - 確保產出的 UI 仍具有正確的無障礙名稱/角色/值 (name/role/value)、鍵盤行為、焦點管理和可見標籤。
- 如果沒有元件函式庫（或不存在所需的元件），請優先使用原生 HTML 元素/屬性而非 ARIA。
- 僅在必要時使用 ARIA（當原生語義已起作用時，不要向原生元素添加 ARIA）。
- 確保正確的無障礙 **名稱 (name)、角色 (role)、值 (value)、狀態 (states) 和屬性 (properties)**。
- 所有互動元素皆可透過鍵盤操作，具有清晰可見的焦點，且沒有鍵盤陷阱。
- 不要聲稱輸出是「完全無障礙的」。

## 包容性語言 (MUST)

- 在任何面向使用者的文字中，使用尊重、包容且以人為本的語言。
- 避免對能力、認知或經驗產生刻板印象或假設。

## 認知負荷 (SHOULD)

- 偏好使用簡單易懂的語言。
- 使用一致的頁面結構（地標，landmarks）。
- 保持導覽順序一致。
- 保持介面整潔簡單（避免不必要的干擾）。

## 結構與語義

### 頁面結構 (MUST)

- 適當地使用地標 (`header`, `nav`, `main`, `footer`)。
- 使用標題來介紹章節；避免跳過標題層級。
- 頁面主題務必僅使用一個 `h1`。

### 頁面標題 (SHOULD)

- 設定具有描述性的 `<title>`。
- 偏好格式：「唯一頁面 - 章節 - 網站」。

## 鍵盤與焦點

### 核心規則 (MUST)

- 所有互動元素皆可透過鍵盤操作。
- Tab 鍵順序遵循閱讀順序且可預測。
- 焦點始終可見。
- 隱藏內容不可獲得焦點 (`hidden`, `display:none`, `visibility:hidden`)。
- 靜態內容絕不可透過 Tab 鍵獲取焦點。
  - 例外：如果元素需要程式化焦點，請使用 `tabindex="-1"`。
- 焦點絕不可被困住（陷阱）。

### 跳過連結 / 繞過區塊 (MUST)

提供一個「跳過連結」作為第一個可獲取焦點的元素。

```html
<header>
  <a href="#maincontent" class="sr-only">跳過並直接前往主要內容</a>
  <!-- 標頭內容 -->
</header>
<nav>
  <!-- 導覽 -->
</nav>
<main id="maincontent" tabindex="-1">
  <h1><!-- 頁面標題 --></h1>
  <!-- 內容 -->
</main>
```

```css
.sr-only:not(:focus):not(:active) {
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
  height: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
  width: 1px;
}
```

### 複合元件 (SHOULD)

如果元件在自身內部使用方向鍵導覽（頁籤、清單框、類選單 UI、格狀/日期選擇器）：

- 為複合容器或其中一個子項提供一個 Tab 停駐點。
- 使用 roving tabindex 或 `aria-activedescendant` 管理內部焦點。

Roving tabindex (SHOULD):

- 務必僅有一個可獲取焦點的項目具有 `tabindex="0"`；其他所有項目皆為 `-1`。
- 方向鍵透過交換 tabindex 並呼叫 `.focus()` 來移動焦點。

`aria-activedescendant` (SHOULD):

- 容器具有 `tabindex="0"` 和 `aria-activedescendant="IDREF"`。
- 方向鍵更新 `aria-activedescendant`。

## 低視力與對比度 (MUST)

### 對比度要求 (MUST)

- 文字對比度：至少 4.5:1（大文字：3:1）。
  - 大文字指至少 24px 的一般字體或 18.66px 的粗體。
- 焦點指示器和關鍵控制項邊界：與相鄰顏色相比至少 3:1。
- 不要僅依賴顏色來傳達資訊（錯誤/成功/必填/已選取）。請提供文字和/或具有無障礙名稱的圖示。

### 顏色產生規則 (MUST)

- 不要隨意發明顏色。
  - 使用專案核准的設計權杖 (design tokens，如 CSS 變數)。
  - 如果沒有調色盤，請定義一個小的權杖調色盤並僅使用這些權杖。
- 文字和關鍵 UI 特徵避免使用 alpha 通道（`opacity`, `rgba`, `hsla`），因為對比度會變得依賴背景且通常會失敗。
- 確保所有互動狀態的對比度：預設、懸停 (hover)、啟用 (active)、焦點 (focus)、已造訪 (visited，連結) 和禁用 (disabled)。

### 不確定時的安全預設值 (SHOULD)

- 偏好在極淺背景上使用極深文字，或反之亦然。
- 避免在白色背景上使用中灰色文字；淡化文字仍應符合 4.5:1。

### 權杖化調色盤契約 (SHOULD)

- 定義並使用權杖，例如：`--color-bg`, `--color-text`, `--color-muted-text`, `--color-link`, `--color-border`, `--color-focus`, `--color-danger`, `--color-success`。
- 僅透過這些權杖分配 UI 顏色（避免分散的內嵌十六進位值）。

### 驗證 (MUST)

對比度驗證包含在「最終驗證檢查表」中。

## 高對比 / 強制色彩模式 (MUST)

### 支援作業系統層級的無障礙功能 (MUST)

- 絕不覆寫或干擾作業系統的無障礙設定。
- UI 必須自動適應高對比 / 強制色彩模式 (High Contrast / Forced Colors mode)。
- 避免使用與使用者選取的系統顏色衝突的硬編碼顏色。

### 必要時使用 `forced-colors` 媒體查詢 (SHOULD)

僅在系統預設值不足時使用 `@media (forced-colors: active)`。

```css
@media (forced-colors: active) {
  /* 範例：使用邊框取代 box-shadow（在強制色彩模式下會被隱藏） */
  .button {
    border: 2px solid ButtonBorder;
  }
}
```

在強制色彩模式下，避免依賴：

- 方框陰影 (Box shadows)
- 背景圖片
- 裝飾性漸層

### 在強制色彩中尊重使用者配色方案 (MUST)

- 使用系統顏色關鍵字（例如 `ButtonText`, `ButtonBorder`, `CanvasText`, `Canvas`）。
- 不要在 `@media (forced-colors: active)` 內部使用固定的十六進位/RGB 顏色。

### 不要禁用強制色彩 (MUST)

- 除非絕對必要且有明確理由，否則不要使用 `forced-color-adjust: none`。
- 如果某個特定元素需要它，請提供一個在強制色彩模式下仍然有效的無障礙替代方案。

### 圖示 (MUST)

- 圖示必須適應文字顏色。
- SVG 圖示的填滿/筆劃偏好使用 `currentColor`；避免在 SVG 內部嵌入固定顏色。

```css
svg {
  fill: currentColor;
  stroke: currentColor;
}
```

## 重新排列 (Reflow, WCAG 2.2 SC 1.4.10) (MUST)

### 目標 (MUST)

在相當於 320 CSS px 的寬度下，所有內容和功能必須保持可用，且不需要雙向捲動。

### 核心原則 (MUST)

- 保留資訊與功能：不移除、遮蔽或截斷任何重要內容。
- 在窄寬度下，多欄佈局必須堆疊成單欄；文字必須換行；控制項應垂直重新排列。
- 使用者不應需要左右捲動來閱讀多行文字。
- 如果內容在窄佈局中被折疊，完整內容/功能必須在 1 次點擊內可用（例如：溢位選單、對話框、工具提示）。

### 工程要求 (MUST)

- 使用具有流體尺寸的響應式佈局原語 (`flex`, `grid`)；啟用文字換行。
- 避免使用會強制在 320px 下產生水平捲動的固定寬度。
- 避免在會導致內容遺失時使用絕對定位和 `overflow: hidden`。
- 媒體和容器在 320px 下不得超出視窗（例如：圖片/影片/畫布/iframe 偏好使用 `max-width: 100%`）。
- 在 flex/grid 佈局中，確保子項可以收縮/換行（常見修復：在 flex/grid 子項上使用 `min-width: 0`）。
- 處理長字串（URL、權杖）且不強制溢位（常見修復：`overflow-wrap: anywhere` 或等效方式）。
- 確保所有互動元素在 320px 下保持可見、可觸及且可操作。

### 例外情況 (SHOULD)

如果某個元件確實需要二維佈局才能表達含義/用法（例如：大型資料表、地圖、圖表、統計圖、遊戲、簡報），則僅允許在元件層級進行水平捲動。

- 頁面整體仍必須能重新排列。
- 該元件必須保持完全可用（所有內容皆可觸及；控制項可操作）。

## 控制項與標籤

### 可見標籤 (MUST)

- 每個互動元素都有一個可見標籤。
- 標籤不能在輸入文字時或欄位已有值後消失。

### 語音存取 (MUST)

- 每個互動元素的無障礙名稱必須包含可見標籤。
  - 如果使用 `aria-label`，請包含視覺標籤文字。
- 如果多個控制項共用相同的可見標籤（例如許多「移除」按鈕），請使用 `aria-label` 保留可見標籤文字並添加上下文（例如「移除項目：襪子」）。

## 表單

### 標籤與說明文字 (MUST)

- 每個表單控制項都有一個程式化標籤。
  - 偏好使用 `<label for="...">`。
- 標籤描述輸入目的。
- 如果存在說明文字，請使用 `aria-describedby` 進行關聯。

### 必填欄位 (MUST)

- 在視覺上（通常是 `*`）和程式化上 (`aria-required="true"`) 指示必填欄位。

### 錯誤與驗證 (MUST)

- 提供解釋如何修復問題的錯誤訊息。
- 對於無效欄位使用 `aria-invalid="true"`；在有效時將其移除。
- 透過 `aria-describedby` 將行內錯誤與欄位關聯。
- 提交按鈕不應僅為了防止提交而被禁用。
- 在提交含有無效輸入的表單時，將焦點移至第一個無效的控制項。

## 圖像與圖片

所有圖像包括 `img`, `svg`、圖示字體和表情符號 (emojis)。

- 具資訊性的圖像必須具有具意義的替代文字。
  - `img`：使用 `alt`。
  - `svg`：偏好使用 `role="img"` 和 `aria-label`/`aria-labelledby`。
- 裝飾性圖像必須隱藏。
  - `img`：`alt=""`。
  - 其他：`aria-hidden="true"`。

## 導覽與選單

- 使用語義化導覽：具有清單和連結的 `<nav>`。
- 不要將 `role="menu"` / `role="menubar"` 用於網站導覽。
- 對於可展開的導覽：
  - 切換 `aria-expanded` 狀態。
  - `Escape` 鍵可以關閉開啟的選單。

## 表格與格狀佈局

### 靜態資料表格 (MUST)

- 對於靜態表格資料使用 `<table>`。
- 使用 `<th>` 來關聯標頭。
  - 欄標頭位於第一列。
  - 列標頭（如果存在）在每一列中使用 `<th>`。

### 動態 UI 格狀佈局 (SHOULD)

- 僅對真正的互動/動態體驗使用 grid 角色。
- 如果使用 `role="grid"`，格狀單元格必須巢狀在列 (rows) 中，以便確定標頭/單元格的關係。
- 使用方向鍵在格狀佈局中導覽。

## 最終驗證檢查表 (MUST)

在完成輸出之前，請明確驗證：

- 結構與語義：地標、標題，以及頁面主題的一個 `h1`。
- 鍵盤與焦點：可操作的控制項、可見的焦點、可預測的 Tab 鍵順序、無陷阱、跳過連結有效。
- 控制項與標籤：存在可見標籤並包含在無障礙名稱中。
- 表單：標籤、必填指示器、錯誤 (`aria-invalid` + `aria-describedby`)、焦點移至第一個無效項。
- 對比度：符合 4.5:1 / 3:1 閾值，焦點/邊界符合 3:1，顏色不是唯一的提示。
- 強制色彩：不破壞作業系統的高對比 / 強制色彩；在 `forced-colors: active` 中使用系統顏色。
- 重新排列：在 320 CSS px 下（以及 200% 縮放時），一般文字沒有雙向捲動；無內容遺失；控制項保持可操作。
- 圖像：具資訊性的有替代方案；裝飾性的已隱藏。
- 表格/格狀佈局：表格使用 `<th>`；格狀佈局（需要時）以列 and 單元格建構。

## 最終備註

在產生 HTML 時請考量無障礙性，但可能仍存在無障礙問題；仍建議進行手動審查和測試（例如使用 Accessibility Insights）。
