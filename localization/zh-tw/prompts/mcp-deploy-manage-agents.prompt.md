---
mode: 'agent'
tools: ['changes', 'search/codebase', 'edit/editFiles', 'problems']
description: '在 Microsoft 365 系統管理中心部署和管理基於 MCP 的宣告式代理程式，包含治理、指派和組織發佈'
model: 'gpt-4.1'
tags: [mcp, m365-copilot, deployment, admin, agent-management, governance]
---

# 部署與管理基於 MCP 的代理程式

在 Microsoft 365 系統管理中心部署、管理及治理基於 MCP 的宣告式代理程式，以進行組織發佈與控制。

## 代理程式類型

### 由組織發佈
- 使用預定義的指令和動作建構
- 遵循結構化邏輯以處理可預測的任務
- 需要管理員核准和發佈程序
- 支援合規性與治理要求

### 由建立者共用
- 在 Microsoft 365 Copilot Studio 或 Agent Builder 中建立
- 直接共用給特定使用者
- 透過搜尋、動作、連接器、API 強化功能
- 管理員可在代理程式登錄中檢視

### Microsoft 代理程式
- 由 Microsoft 開發與維護
- 與 Microsoft 365 服務整合
- 已預先核准且可直接使用

### 外部合作夥伴代理程式
- 由經過驗證的外部開發者/廠商建立
- 需經管理員核准與控制
- 可設定可用性與權限

### 前沿代理程式 (Frontier Agents)
- 實驗性或先進功能
- 可能需要有限的部署或額外監督
- 範例：
  - **App Builder 代理程式**：透過 M365 Copilot 或 Power Platform 系統管理中心管理
  - **工作流 (Workflows) 代理程式**：透過 Power Platform 系統管理中心管理的流程自動化

## 管理員角色與權限

### 必要角色
- **AI 管理員**：完整的代理程式管理能力
- **全域讀取者**：唯讀存取權限 (無法編輯)

### 最佳做法
- 使用權限最少的角色
- 僅在緊急情況下使用「全域管理員」
- 遵循最小權限原則

## Microsoft 365 系統管理中心中的代理程式管理

### 存取代理程式管理
1. 前往 [Microsoft 365 系統管理中心](https://admin.microsoft.com/)
2. 瀏覽至 **代理程式** 頁面
3. 檢視可用、已部署或已封鎖的代理程式

### 可用動作

**檢閱代理程式**
- 依可用性篩選 (可用、已部署、已封鎖)
- 搜尋特定代理程式
- 檢視代理程式詳細資訊 (名稱、建立者、日期、裝載產品、狀態)

**部署代理程式**
發佈選項：
1. **代理程式市集**：提交至合作夥伴中心進行驗證與公開發佈
2. **組織部署**：IT 管理員部署給所有或選定的員工

**管理代理程式週期**
- **發佈**：使代理程式可供組織使用
- **部署**：指派給特定使用者或群組
- **封鎖**：防止代理程式被使用
- **移除**：從組織中刪除代理程式

**設定存取權限**
- 為特定使用者群組設定可用性
- 管理每個代理程式的權限
- 控制哪些代理程式出現在 Copilot 中

## 部署工作流程

### 發佈至組織

**對於代理程式開發者：**
1. 使用 Microsoft 365 Agents Toolkit 建構代理程式
2. 在開發環境中進行徹底測試
3. 提交代理程式進行核准
4. 等待管理員檢閱

**對於管理員：**
1. 在系統管理中心檢閱提交的代理程式
2. 驗證合規性與安全性
3. 核准供組織使用
4. 設定部署設定
5. 發佈給選定的使用者或全組織

### 透過代理程式市集部署

**開發者步驟：**
1. 完成代理程式開發與測試
2. 封裝代理程式以供提交
3. 提交至合作夥伴中心
4. 等待驗證程序
5. 收到核准通知
6. 代理程式出現在 Copilot 市集中

**管理員步驟：**
1. 在 Copilot 市集中探索代理程式
2. 檢閱代理程式詳細資訊與權限
3. 指派給組織或使用者群組
4. 監控使用情況與回饋

### 部署組織代理程式

**管理員部署選項：**
```
全組織：
- 所有持有 Copilot 授權的員工
- 自動出現在 Copilot 中

基於群組：
- 特定部門或團隊
- 安全性群組指派
- 基於角色的存取控制 (RBAC)
```

**組態步驟：**
1. 瀏覽至系統管理中心中的「代理程式」頁面
2. 選取要部署的代理程式
3. 選擇部署範圍：
   - 所有使用者
   - 特定安全性群組
   - 個別使用者
4. 設定可用性狀態
5. 如果適用，設定權限
6. 部署並監控

## 使用者體驗

### 代理程式探索
使用者可在以下位置找到代理程式：
- Microsoft 365 Copilot 中心
- Copilot 介面中的代理程式選取器
- 組織的代理程式目錄

### 代理程式存取控制
使用者可以：
- 在互動期間切換代理程式的開關
- 在其體驗中新增/移除代理程式
- 右鍵按一下代理程式以管理喜好設定
- 僅存取管理員核准的代理程式

### 代理程式使用
- 代理程式出現在 Copilot 側邊欄
- 使用者選取代理程式以提供內容
- 查詢會透過選取的代理程式路由
- 回應會運用代理程式的功能

## 治理與合規性

### 安全性考量
- **資料存取**：檢閱代理程式可存取的資料
- **API 權限**：驗證必要的權限範圍 (Scopes)
- **驗證**：確保安全的 OAuth 流程
- **外部連線**：評估外部整合的風險

### 合規性要求
- **資料落地 (Data Residency)**：驗證資料留在邊界內
- **隱私權政策**：檢閱代理程式隱私權聲明
- **使用規定**：驗證可接受的使用政策
- **稽核記錄**：監控代理程式的使用情況與活動

### 監控與報告
追蹤：
- 代理程式採用率
- 使用者回饋與滿意度
- 錯誤率與效能
- 安全事件或違規行為

## MCP 專屬管理

### MCP 代理程式特性
- 透過模型內容協定連線至外部系統
- 使用 MCP 伺服器公開的工具
- 需要 OAuth 2.0 或 SSO 驗證
- 支援與 REST API 代理程式相同的治理機制

### MCP 代理程式驗證
驗證：
- MCP 伺服器 URL 可存取
- 驗證組態安全
- 匯入的工具適當
- 回應資料不會公開敏感資訊
- 伺服器遵循安全性最佳做法

### MCP 代理程式部署
與 REST API 代理程式流程相同：
1. 在系統管理中心檢閱
2. 驗證 MCP 伺服器合規性
3. 測試驗證流程
4. 部署給使用者/群組
5. 監控效能

## 代理程式設定與組態

### 組織設定
在租戶等級設定：
- 啟用/停用代理程式建立
- 設定預設權限
- 設定核准工作流
- 定義合規性政策

### 每個代理程式的設定
為個別代理程式設定：
- 可用性 (開啟/關閉)
- 使用者指派 (所有/群組/個人)
- 權限範圍
- 使用限制或配額

### 環境路由
針對基於 Power Platform 的代理程式：
- 設定預設環境
- 為 Copilot Studio 啟用環境路由
- 透過 Power Platform 系統管理中心管理流程

## 共用代理程式管理

### 檢視共用代理程式
管理員可以看到：
- 所有共用代理程式的清單
- 建立者資訊
- 建立日期
- 裝載產品
- 可用性狀態

### 管理共用代理程式
管理員動作：
- 搜尋特定的共用代理程式
- 檢視代理程式功能
- 封鎖不安全或不合規的代理程式
- 監控代理程式週期

### 使用者存取共用代理程式
使用者透過以下方式存取：
- 各種介面上的 Microsoft 365 Copilot
- 代理程式專屬任務與協助
- 建立者定義的功能

## 最佳做法

### 部署前
- 對小規模使用者群組進行 **試點測試 (Pilot test)**
- 從早期採用者那裡 **收集回饋**
- **驗證安全性** 與合規性
- **記錄** 代理程式的能力與限制
- 為使用者提供代理程式使用 **訓練**

### 部署期間
- **分階段部署** 以管理採用情況
- **監控效能** 與錯誤
- 持續 **收集回饋**
- 及時 **處理問題**
- 向使用者 **宣佈** 可用性

### 部署後
- **追蹤指標**：採用率、滿意度、錯誤
- **反覆運算**：根據回饋進行改進
- **更新**：讓代理程式與新功能保持同步
- **停用**：移除過時或未使用的代理程式
- **檢閱**：定期進行安全性與合規性稽核

### 溝通
- 向使用者宣佈新代理程式
- 提供文件與範例
- 分享最佳做法與使用案例
- 強調效益與能力
- 提供支援管道

## 疑難排解

### 代理程式未出現
- 檢查系統管理中心中的部署狀態
- 驗證使用者是否在指派的群組中
- 確認代理程式未被封鎖
- 檢查使用者是否持有 Copilot 授權
- 重新整理 Copilot 介面

### 驗證失敗
- 驗證 OAuth 認證是否有效
- 檢查使用者是否具備必要權限
- 確認 MCP 伺服器可存取
- 獨立測試驗證流程

### 效能問題
- 監控 MCP 伺服器回應時間
- 檢查網路連線
- 在系統管理中心檢閱錯誤記錄
- 驗證代理程式未受速率限制 (Rate-limited)

### 違反合規性
- 如果不安全，立即封鎖代理程式
- 檢閱稽核記錄以找出違規行為
- 調查資料存取模式
- 更新政策以防止再次發生

## 資源

- [Microsoft 365 系統管理中心](https://admin.microsoft.com/)
- [Power Platform 系統管理中心](https://admin.powerplatform.microsoft.com/)
- [合作夥伴中心](https://partner.microsoft.com/) 用於提交代理程式
- [Microsoft Agent 365 概觀](https://learn.microsoft.com/en-us/microsoft-agent-365/overview)
- [代理程式登錄文件](https://learn.microsoft.com/en-us/microsoft-365/admin/manage/agent-registry)

## 工作流程

詢問使用者：
1. 此代理程式已準備好部署，還是在開發中？
2. 誰應該擁有存取權限 (所有使用者、特定群組、個人)？
3. 是否有需要處理的合規性或安全性要求？
4. 這應該發佈給組織還是公開商店？
5. 需要哪些監控與報告？

然後提供：
- 逐步部署指南
- 系統管理中心組態步驟
- 使用者指派建議
- 治理與合規性檢核表
- 監控與報告計畫
