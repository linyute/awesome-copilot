---
name: workiq-copilot
description: '引導 Copilot CLI 如何使用 WorkIQ CLI/MCP 伺服器來查詢 Microsoft 365 Copilot 資料（電子郵件、會議、文件、Teams、人員），以獲取即時背景資訊、摘要和建議。'
---

# WorkIQ Copilot 技能

## 概觀

WorkIQ (公開預覽版) 讓 Copilot 能以自然語言查詢 Microsoft 365 資料。它支援行程、文件、Teams 訊息、電子郵件對話串、後續追蹤、專案關係人摘要等。每當任務需要本機儲存庫以外的即時組織情資時，請使用此技能。

## 支援的資料與範例提示

- **電子郵件** – 「摘要 Sarah 關於預算的電子郵件。」
- **會議** – 「這週我有哪些即將舉行的會議？」
- **文件** – 「尋找近期關於 Q4 規劃的文件。」
- **Teams** – 「摘要今天 Engineering 頻道中的訊息。」
- **人員/專案** – 「誰正在參與 Project Alpha？」

## 取得存取權限

1. **Copilot CLI 外掛程式 (偏好方式)**
   - `copilot`
   - `/plugin marketplace add github/copilot-plugins`
   - `/plugin install workiq@copilot-plugins`
   - 重新啟動 Copilot CLI。
2. **獨立 CLI / MCP 伺服器**
   - `npm install -g @microsoft/workiq` (或 `npx -y @microsoft/workiq mcp`)。
   - 如果需要，執行 `workiq mcp` 以公開 MCP 工具。
3. **租戶同意**
   - 首次使用時會提示 Microsoft 365 管理者同意 (EULA + 權限)。非管理者必須聯繫租戶管理者，根據《租戶管理者啟用指南》進行核准。

## 準備工作檢查清單

- 執行 `Get-Command workiq` 以確保二進位檔案可用。
- 透過 `workiq accept-eula` 接受一次 EULA。
- 確認正確的租戶 (若與預設 `common` 不同，請使用 `-t <tenant-id>`)。
- 準備好在提示時於瀏覽器中完成裝置登入。

## 核心工作流程

1. **釐清意圖** – 議程、待辦事項、文件查閱、人員搜尋、風險摘要等。
2. **撰寫精確提示** – 包含時間範圍、來源或主題 (例如：「摘要今天 #eng 中的 Teams 貼文」)。
3. **執行命令** – `workiq ask --question "<提示>"` (如果需要，可使用 `-q` 簡寫)。
4. **監控執行** – 長答案可能會串流顯示；請等待回應結束後再發出其他請求。
5. **摘要與遮罩** – 醒目提示洞察、註記衝突/任務，除非必要，否則避免貼上原始連結。
6. **提供後續動作** – 預留時間、撰寫草稿、深入查詢等。

## 命令參考

| 命令 | 用途 |
| --------------------------------- | ------------------------------------------------------------- |
| `workiq --help` | 顯示全域選項。 |
| `workiq version` | 顯示安裝的版本。 |
| `workiq accept-eula` | 接受授權 (首次使用)。 |
| `workiq ask` | 互動模式。 |
| `workiq ask --question "..."` | 詢問特定問題 (如果偏好，可使用 `-q` 簡寫)。 |
| `workiq ask -t <tenant> -q "..."` | 目標設為特定租戶。 |
| `workiq mcp` | 啟動 MCP stdio 伺服器 (向其他代理程式公開 WorkIQ 工具)。 |

## 提示模式

- 議程：「我明天的行事曆上有什麼？」
- 待辦事項：「摘要今天客戶同步會議的後續追蹤事項。」
- 文件：「列出關於 Contoso FY26 路線圖的 PowerPoint。」
- 通訊：「我的主管對截止日期說了什麼？」
- 洞察：「過去三次會議中出現了哪些阻礙因素？」
- 規劃：「建議週二下午的專注時段。」

## 回應指南

- 保持摘要簡潔 (2-3 句)，點出負載、優先順序、阻礙因素和選用的後續步驟。
- 除非使用者特別需要連結，否則以一般方式提及會議/文件。
- 說明 WorkIQ 是否可以繼續 (例如：「如果需要，WorkIQ 可以顯示週四至週日」)。
- 將 WorkIQ 建議的動作對應到明確的提議 (預留時間、發送後續郵件、要求錄音、執行深入查詢)。

## 最佳實踐

- 偏好精確的提示以減少雜訊；如果需要，可執行多個查詢。
- 在回應前，邏輯性地結合輸出結果 (議程 + 衝突 + 待辦事項)。
- 尊重隱私：除非明確要求，否則不要公開出席者名單或機密片段。
- 記錄執行了哪些命令，以便後續步驟參考 (「詢問 WorkIQ 議程 + 衝突」)。
- 當其他代理程式/工作流程需要直接存取工具時，使用 MCP 模式 (`workiq mcp`)。

## 疑難排解

- **遺漏 CLI** – 透過 npm 安裝或確保已設定 PATH；如果不可用，請通知使用者。
- **同意/驗證錯誤** – 在管理員授予權限或完成裝置登入後重新執行命令。
- **回應過長/不完整** – 使用縮小的範圍重新執行，或要求特定資料切片 (按天/專案/人員)。
- **命令掛起** – 在終端機中取消正在執行的命令 (例如，使用 Ctrl+C) 或重新啟動 Copilot CLI 工作階段，然後重試；確保已完成瀏覽器登入。

## 建議提供的後續動作

- 在建議的時間預留專注/緩衝時段。
- 參考 WorkIQ 指引撰寫重新安排/拒絕訊息草稿。
- 要求重疊工作階段的錄音或摘要。
- 將待辦事項擷取到任務追蹤器中。
- 執行額外的 WorkIQ 查詢 (按專案、專案關係人、時間範圍) 以進行深入分析。
